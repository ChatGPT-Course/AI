
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –∫—É—Ä—Å–∞</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
      background: #ffffff;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .main-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
      padding: 2rem 1rem;
      text-align: center;
      max-width: 100%;
      margin: 0 auto;
      padding-bottom: 120px;
    }

    .welcome-section {
      margin-bottom: 3rem;
      width: 100%;
      max-width: 600px;
      background: #ffffff;
      border-radius: 20px;
      padding: 2rem;
      border: 1px solid #e0e0e0;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .welcome-title {
      font-size: 2.2rem;
      font-weight: 700;
      color: #2c3e50;
      margin-bottom: 0.5rem;
      line-height: 1.2;
    }

    .welcome-subtitle {
      font-size: 1.1rem;
      color: #7f8c8d;
      margin-bottom: 1rem;
      line-height: 1.5;
    }

    .welcome-description {
      font-size: 0.95rem;
      color: #5a6c7d;
      line-height: 1.6;
      max-width: 100%;
    }

    .modules-path {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 100%;
      max-width: 600px;
      position: relative;
      padding: 2rem 0;
    }

    .module-item {
      display: flex;
      flex-direction: column;
      position: relative;
      width: 100%;
      margin-bottom: 2.5rem;
    }

    .module-item:nth-child(odd) .module-card {
      align-self: flex-start;
      margin-left: 1rem;
    }

    .module-item:nth-child(even) .module-card {
      align-self: flex-end;
      margin-right: 1rem;
    }

    .module-card {
      background: #ffffff;
      border-radius: 12px;
      padding: 1rem;
      text-align: center;
      transition: all 0.4s ease;
      box-shadow: 0 2px 15px rgba(0, 0, 0, 0.08);
      width: 180px;
      position: relative;
      cursor: pointer;
      border: 2px solid transparent;
    }

    /* –°–æ—Å—Ç–æ—è–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫ */
    .module-card.completed {
      background: linear-gradient(135deg, #4CAF50, #45a049);
      color: white;
      transform: scale(1.02);
    }

    .module-card.current {
      background: linear-gradient(135deg, #FF9800, #F57C00);
      color: white;
      animation: currentPulse 2s ease-in-out infinite;
      border: 2px solid #FFB74D;
      box-shadow: 0 0 15px rgba(255, 152, 0, 0.4);
    }

    .module-card.locked {
      background: #f5f5f5;
      color: #999;
      cursor: not-allowed;
      opacity: 0.7;
    }

    .module-card.intro-pulse {
      animation: introPulse 2s ease-in-out infinite;
      border: 2px solid #2196F3;
      box-shadow: 0 0 15px rgba(33, 150, 243, 0.4);
    }

    /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
    @keyframes currentPulse {
      0%, 100% {
        transform: scale(1.02);
        box-shadow: 0 0 15px rgba(255, 152, 0, 0.4);
      }
      50% {
        transform: scale(1.05);
        box-shadow: 0 0 25px rgba(255, 152, 0, 0.6);
      }
    }

    @keyframes introPulse {
      0%, 100% {
        transform: scale(1);
        box-shadow: 0 0 15px rgba(33, 150, 243, 0.4);
      }
      50% {
        transform: scale(1.03);
        box-shadow: 0 0 25px rgba(33, 150, 243, 0.6);
      }
    }

    @keyframes progressWave {
      0% {
        background-position: 0% 0%;
      }
      100% {
        background-position: 100% 100%;
      }
    }

    .module-icon {
      font-size: 2rem;
      margin-bottom: 0.6rem;
      display: block;
    }

    .module-title {
      font-size: 1rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
    }

    .module-description {
      line-height: 1.3;
      font-size: 0.75rem;
      margin: 0 0 1rem 0;
      opacity: 0.9;
    }

    .module-start-btn {
      border: none;
      border-radius: 8px;
      padding: 0.6rem 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      width: 100%;
      font-size: 0.8rem;
    }

    .module-card.completed .module-start-btn {
      background: rgba(255, 255, 255, 0.2);
      color: white;
      border: 2px solid rgba(255, 255, 255, 0.3);
    }

    .module-card.current .module-start-btn {
      background: rgba(255, 255, 255, 0.9);
      color: #FF9800;
      font-weight: 700;
    }

    .module-card.locked .module-start-btn {
      background: #e0e0e0;
      color: #999;
      cursor: not-allowed;
    }

    .module-card:not(.locked) .module-start-btn:hover {
      transform: translateY(-2px);
    }

    /* –î–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏ */
    .connection-line {
      position: absolute;
      border-radius: 3px;
      z-index: 1;
      overflow: hidden;
    }

    .connection-line.diagonal-right {
      width: 100px;
      height: 4px;
      top: 50%;
      right: -50px;
      transform-origin: right center;
      transform: rotate(30deg);
      background: #e0e0e0;
    }

    .connection-line.diagonal-left {
      width: 100px;
      height: 4px;
      top: 50%;
      left: -50px;
      transform-origin: left center;
      transform: rotate(-30deg);
      background: #e0e0e0;
    }

    .connection-line.completed {
      background: linear-gradient(90deg, #4CAF50, #45a049);
      animation: progressWave 2s ease-in-out infinite;
    }

    .connection-line.active {
      background: linear-gradient(90deg, #4CAF50 0%, #4CAF50 40%, #FF9800 60%, #FF9800 100%);
      animation: progressWave 2.5s ease-in-out infinite;
    }

    .connection-line.completed::after,
    .connection-line.active::after {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
      animation: shimmer 3s infinite;
    }

    @keyframes shimmer {
      0% { left: -100%; }
      100% { left: 100%; }
    }

    /* –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å */
    .navigation-panel {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: #ffffff;
      border-top: 1px solid #e0e0e0;
      padding: 1rem 0;
      display: flex;
      justify-content: space-around;
      align-items: center;
      box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
    }

    .nav-button {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 0.5rem 1rem;
      background: none;
      border: none;
      cursor: pointer;
      transition: all 0.2s ease;
      min-width: 70px;
      border-radius: 8px;
    }

    .nav-button:hover {
      background: #f8f9fa;
    }

    .nav-button.active {
      background: #e3f2fd;
    }

    .nav-icon {
      width: 24px;
      height: 24px;
      margin-bottom: 0.3rem;
      fill: #6c757d;
      transition: fill 0.2s ease;
    }

    .nav-button:hover .nav-icon,
    .nav-button.active .nav-icon {
      fill: #2196F3;
    }

    .nav-label {
      font-size: 0.8rem;
      color: #6c757d;
      font-weight: 500;
      transition: color 0.2s ease;
    }

    .nav-button:hover .nav-label,
    .nav-button.active .nav-label {
      color: #2196F3;
    }

    /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
    @media (max-width: 768px) {
      .main-content {
        padding: 1rem 0.5rem;
        padding-bottom: 100px;
      }

      .welcome-section {
        padding: 1.5rem;
        margin-bottom: 2rem;
      }

      .welcome-title {
        font-size: 1.8rem;
      }

      .welcome-subtitle {
        font-size: 1rem;
      }

      .modules-path {
        padding: 1rem 0;
      }

      .module-item {
        margin-bottom: 1.5rem;
      }

      .module-item:nth-child(odd) .module-card,
      .module-item:nth-child(even) .module-card {
        align-self: center;
        margin-left: 0;
        margin-right: 0;
      }

      .module-card {
        width: 100%;
        max-width: 220px;
        padding: 1rem;
      }

      .module-icon {
        font-size: 1.8rem;
      }

      .module-title {
        font-size: 0.95rem;
      }

      .module-description {
        font-size: 0.7rem;
      }

      .connection-line.diagonal-right,
      .connection-line.diagonal-left {
        display: none;
      }
    }
  </style>
</head>
<body>
  <div class="main-content">
    <div class="welcome-section" id="welcomeSection">
      <h1 class="welcome-title">–û–±—É—á–∞—é—â–∏–µ –º–æ–¥—É–ª–∏</h1>
      <p class="welcome-subtitle">–í—ã–±–µ—Ä–∏—Ç–µ –º–æ–¥—É–ª—å –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è</p>
      <p class="welcome-description">–ü—Ä–æ–π–¥–∏—Ç–µ –≤—Å–µ –º–æ–¥—É–ª–∏ –ø–æ –ø–æ—Ä—è–¥–∫—É –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞</p>
    </div>

    <div class="modules-path" id="modulesPath">
      <!-- –ú–æ–¥—É–ª–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ JavaScript -->
    </div>
  </div>

  <div class="navigation-panel">
    <button class="nav-button active" id="guidesBtn">
      <svg class="nav-icon" viewBox="0 0 24 24">
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/>
      </svg>
      <span class="nav-label">Guides</span>
    </button>

    <button class="nav-button" id="challengesBtn">
      <svg class="nav-icon" viewBox="0 0 24 24">
        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
      </svg>
      <span class="nav-label">Challenges</span>
    </button>

    <button class="nav-button" id="aiToolsBtn">
      <svg class="nav-icon" viewBox="0 0 24 24">
        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
      </svg>
      <span class="nav-label">AI Tools</span>
    </button>

    <button class="nav-button" id="profileBtn">
      <svg class="nav-icon" viewBox="0 0 24 24">
        <path d="M12 2C13.1 2 14 2.9 14 4C14 5.1 13.1 6 12 6C10.9 6 10 5.1 10 4C10 2.9 10.9 2 12 2ZM21 9V7L15 7V9C15 11.7 12.7 14 10 14S5 11.7 5 9V7H3V9C3 12.4 5.4 15.1 8.5 15.8V18H7V20H17V18H15.5V15.8C18.6 15.1 21 12.4 21 9Z"/>
      </svg>
      <span class="nav-label">Profile</span>
    </button>
  </div>

  <script>
    // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è NocoDB
    const config = {
      orgs: 'weamcfo6',
      projectName: 'p27jdsmk69wuimh',
      tableName: 'mc6qh91f060pv4y',
      apiToken: 'bocQfycJpJsTG_tbwEf8ma8E5rhoig0njMDXFWtJ',
      baseUrl: 'https://app.nocodb.com/api/v1/db/data'
    };

    // –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª–µ–π
    const modules = [
      {
        id: 'intro',
        icon: 'üëã',
        title: '–í—Å—Ç—É–ø–ª–µ–Ω–∏–µ',
        description: '–ó–Ω–∞–∫–æ–º—Å—Ç–≤–æ —Å –∫—É—Ä—Å–æ–º –∏ –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –ø—Ä–∏–Ω—Ü–∏–ø–∞–º–∏ —Ä–∞–±–æ—Ç—ã —Å –ò–ò',
        file: 'intro.html',
        requiredProgress: 0
      },
      {
        id: 'm1',
        icon: 'üß†',
        title: '–ú–æ–¥—É–ª—å 1',
        description: '–û—Å–Ω–æ–≤—ã –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞. –ò–∑—É—á–∏—Ç–µ –±–∞–∑–æ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –∏ –ø—Ä–∏–Ω—Ü–∏–ø—ã',
        file: 'M1.html',
        requiredProgress: 1
      },
      {
        id: 'm2',
        icon: 'üöÄ',
        title: '–ú–æ–¥—É–ª—å 2',
        description: '–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ —Ä–∞–±–æ—Ç—ã —Å –ò–ò. –£–≥–ª—É–±–∏—Ç–µ —Å–≤–æ–∏ –∑–Ω–∞–Ω–∏—è',
        file: 'M2.html',
        requiredProgress: 2
      },
      {
        id: 'm3',
        icon: '‚ö°',
        title: '–ú–æ–¥—É–ª—å 3',
        description: '–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ò–ò. –†–∞–±–æ—Ç–∞ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏',
        file: 'M3.html',
        requiredProgress: 3
      },
      {
        id: 'm4',
        icon: 'üéØ',
        title: '–ú–æ–¥—É–ª—å 4',
        description: '–ú–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ —Ä–∞–±–æ—Ç—ã —Å –ò–ò. –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π',
        file: 'M4.html',
        requiredProgress: 4
      }
    ];

    let userProgress = 0;
    let userPayment = 0;
    let userId = null;
    let lastUpdateTime = 0;
    let checkInterval = null;

    // –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ cookies
    function getCookie(name) {
      const value = `; ${document.cookie}`;
      const parts = value.split(`; ${name}=`);
      if (parts.length === 2) return parts.pop().split(';').shift();
      return null;
    }

    // –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ NocoDB
    async function getUserData(isUpdate = false) {
      userId = getCookie('tg_user_id');
      
      if (!userId) {
        console.error('User ID not found in cookies');
        return;
      }

      try {
        const response = await fetch(`${config.baseUrl}/${config.orgs}/${config.projectName}/${config.tableName}`, {
          headers: {
            'xc-token': config.apiToken
          }
        });

        if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
        
        const data = await response.json();
        const user = data.list.find(u => u.tg_user_id == userId);
        
        if (user) {
          const newProgress = user.progress || 0;
          const newPayment = user.oplata || 0;
          
          // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∏–∑–º–µ–Ω–∏–ª–∏—Å—å –ª–∏ –¥–∞–Ω–Ω—ã–µ
          if (isUpdate && (newProgress !== userProgress || newPayment !== userPayment)) {
            console.log('–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω—ã:', { 
              progress: newProgress, 
              payment: newPayment 
            });
            
            userProgress = newProgress;
            userPayment = newPayment;
            lastUpdateTime = Date.now();
            
            // –ü–ª–∞–≤–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
            updateInterface();
          } else if (!isUpdate) {
            userProgress = newProgress;
            userPayment = newPayment;
            lastUpdateTime = Date.now();
            renderModules();
          }
        } else {
          if (!isUpdate) {
            userProgress = 0;
            userPayment = 0;
            renderModules();
          }
        }
      } catch (error) {
        console.error('Error fetching user data:', error);
        if (!isUpdate) {
          userProgress = 0;
          userPayment = 0;
          renderModules();
        }
      }
    }

    // –ü–ª–∞–≤–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
    function updateInterface() {
      const modulesPath = document.getElementById('modulesPath');
      
      // –î–æ–±–∞–≤–ª—è–µ–º –ø–ª–∞–≤–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥
      modulesPath.style.transition = 'opacity 0.3s ease';
      modulesPath.style.opacity = '0.7';
      
      setTimeout(() => {
        renderModules();
        modulesPath.style.opacity = '1';
      }, 150);
    }

    // –ó–∞–ø—É—Å–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
    function startAutoUpdate() {
      // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –µ—Å–ª–∏ –µ—Å—Ç—å
      if (checkInterval) {
        clearInterval(checkInterval);
      }
      
      // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –∫–∞–∂–¥—ã–µ 3 —Å–µ–∫—É–Ω–¥—ã
      checkInterval = setInterval(() => {
        getUserData(true);
      }, 3000);
      
      console.log('–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –∑–∞–ø—É—â–µ–Ω–∞ (–∫–∞–∂–¥—ã–µ 3 —Å–µ–∫)');
    }

    // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
    function stopAutoUpdate() {
      if (checkInterval) {
        clearInterval(checkInterval);
        checkInterval = null;
        console.log('–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞');
      }
    }

    // –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–æ–¥—É–ª—è
    function getModuleState(module, index) {
      if (userProgress === 5) {
        return 'completed'; // –í—Å–µ –º–æ–¥—É–ª–∏ –∑–∞–≤–µ—Ä—à–µ–Ω—ã
      }
      
      if (module.id === 'intro' && userProgress === 0) {
        return 'intro-pulse'; // –ü—É–ª—å—Å–∞—Ü–∏—è –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è –ø—Ä–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ 0
      }
      
      if (userProgress > module.requiredProgress) {
        return 'completed'; // –ú–æ–¥—É–ª—å –ø—Ä–æ–π–¥–µ–Ω
      }
      
      // –õ–æ–≥–∏–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ –º–æ–¥—É–ª—è
      if (module.id === 'intro' && userProgress === 0) {
        return 'current';
      } else if (module.id === 'm1' && (userProgress >= 1 || userPayment > 0)) {
        return userProgress === 1 ? 'current' : 'completed';
      } else if (userProgress >= module.requiredProgress) {
        return userProgress === module.requiredProgress ? 'current' : 'completed';
      }
      
      return 'locked'; // –ú–æ–¥—É–ª—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω
    }

    // –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–≤—è–∑–∏
    function getConnectionState(moduleIndex) {
      if (userProgress === 5) {
        return 'completed';
      }
      
      if (userProgress > moduleIndex) {
        return 'completed';
      } else if (userProgress === moduleIndex + 1) {
        return 'active';
      }
      
      return '';
    }

    // –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å –º–æ–¥—É–ª–∏
    function renderModules() {
      const modulesPath = document.getElementById('modulesPath');
      modulesPath.innerHTML = '';

      modules.forEach((module, index) => {
        const moduleState = getModuleState(module, index);
        
        // –õ–æ–≥–∏–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
        let isAvailable = false;
        let buttonText = '–ù–∞—á–∞—Ç—å';

        if (module.id === 'intro') {
          isAvailable = true;
        } else if (module.id === 'm1') {
          isAvailable = userProgress >= module.requiredProgress || userPayment > 0;
        } else {
          isAvailable = userProgress >= module.requiredProgress;
        }

        if (moduleState === 'completed') {
          buttonText = '–ü–æ–≤—Ç–æ—Ä–∏—Ç—å';
        } else if (moduleState === 'current') {
          buttonText = '–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å';
        } else if (!isAvailable) {
          buttonText = userPayment === 0 && module.id === 'm1' ? '–¢—Ä–µ–±—É–µ—Ç—Å—è –æ–ø–ª–∞—Ç–∞' : '–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ';
        }
        
        const moduleItem = document.createElement('div');
        moduleItem.className = 'module-item';
        
        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–∏
        const connectionClass = index > 0 ? (index % 2 === 1 ? 'diagonal-right' : 'diagonal-left') : '';
        const connectionLine = index < modules.length - 1 && window.innerWidth > 768 ? 
          `<div class="connection-line ${connectionClass} ${getConnectionState(index)}"></div>` : '';
        
        moduleItem.innerHTML = `
          <div class="module-card ${moduleState}" ${isAvailable ? `onclick="startModule('${module.file}')"` : ''}>
            <div class="module-icon">${module.icon}</div>
            <h3 class="module-title">${module.title}</h3>
            <p class="module-description">${module.description}</p>
            <button class="module-start-btn">${buttonText}</button>
            ${connectionLine}
          </div>
        `;
        
        modulesPath.appendChild(moduleItem);
      });
      
      // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
      updateUserInfo();
    }

    // –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
    function updateUserInfo() {
      const userName = getCookie('tg_name') || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
      const welcomeTitle = document.querySelector('.welcome-title');
      const welcomeSubtitle = document.querySelector('.welcome-subtitle');
      
      if (welcomeTitle) {
        welcomeTitle.textContent = `–ü—Ä–∏–≤–µ—Ç, ${userName}!`;
      }
      
      if (welcomeSubtitle) {
        const progressText = userProgress > 0 ? `–ü—Ä–æ–≥—Ä–µ—Å—Å: ${userProgress}/5` : '–ù–∞—á–Ω–∏—Ç–µ –æ–±—É—á–µ–Ω–∏–µ';
        const paymentText = userPayment > 0 ? ' | –ü–æ–ª–Ω–∞—è –≤–µ—Ä—Å–∏—è ‚úÖ' : ' | –î–µ–º–æ-—Ä–µ–∂–∏–º';
        welcomeSubtitle.textContent = `${progressText}${paymentText}`;
      }
    }

    // –ù–∞—á–∞—Ç—å –º–æ–¥—É–ª—å
    function startModule(file) {
      window.location.href = file;
    }

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
    document.getElementById('guidesBtn').addEventListener('click', () => {
      window.location.href = 'main.html';
    });

    document.getElementById('challengesBtn').addEventListener('click', () => {
      console.log('Challenges clicked');
    });

    document.getElementById('aiToolsBtn').addEventListener('click', () => {
      console.log('AI Tools clicked');
    });

    document.getElementById('profileBtn').addEventListener('click', () => {
      console.log('Profile clicked');
    });

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    document.addEventListener('DOMContentLoaded', () => {
      getUserData();
      startAutoUpdate();
    });

    // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∏ —É—Ö–æ–¥–µ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    window.addEventListener('beforeunload', () => {
      stopAutoUpdate();
    });

    // –í–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
    document.addEventListener('visibilitychange', () => {
      if (document.visibilityState === 'visible') {
        if (!checkInterval) {
          startAutoUpdate();
        }
      } else {
        stopAutoUpdate();
      }
    });
  </script>
</body>
</html>
