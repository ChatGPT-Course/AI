<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –∫—É—Ä—Å–∞</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
      background: #ffffff;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .main-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
      padding: 2rem 1rem;
      text-align: center;
      max-width: 100%;
      margin: 0 auto;
      padding-bottom: 90px;
    }

    .progress-section {
      margin-bottom: 3rem;
      width: 100%;
      max-width: 600px;
      background: #ffffff;
      border-radius: 12px;
      padding: 1.5rem;
      border: 1px solid #e0e0e0;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
    }

    .progress-title {
      font-size: 1.4rem;
      font-weight: 600;
      color: #2c3e50;
      margin-bottom: 0.5rem;
    }

    .progress-subtitle {
      font-size: 0.9rem;
      color: #6c757d;
      margin-bottom: 1rem;
    }

    .overall-progress {
      margin-bottom: 0.5rem;
    }

    .overall-progress-label {
      font-size: 0.85rem;
      color: #6c757d;
      margin-bottom: 0.5rem;
      font-weight: 500;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .overall-progress-bar-container {
      background: #f1f3f4;
      border-radius: 8px;
      height: 10px;
      overflow: hidden;
      position: relative;
    }

    .overall-progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #8b5cf6, #a855f7);
      border-radius: 8px;
      transition: width 0.5s ease;
      position: relative;
    }

    .modules-container {
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
      width: 100%;
      max-width: 800px;
    }

    .module-card {
      background: #ffffff;
      border-radius: 12px;
      padding: 1.5rem;
      text-align: left;
      transition: all 0.3s ease;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
      border: 1px solid #e5e7eb;
      cursor: pointer;
      position: relative;
      overflow: hidden;
    }

    /* –°–æ—Å—Ç–æ—è–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫ */
    .module-card.completed {
      border-color: #10b981;
      background: linear-gradient(135deg, #ecfdf5, #ffffff);
    }

    .module-card.current {
      border-color: #f59e0b;
      background: linear-gradient(135deg, #fffbeb, #ffffff);
      box-shadow: 0 4px 12px rgba(245, 158, 11, 0.15);
    }

    .module-card.locked {
      background: #f9fafb;
      border-color: #d1d5db;
      cursor: not-allowed;
      opacity: 0.7;
    }

    .module-card:hover:not(.locked) {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
    }

    .module-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 1rem;
    }

    .module-label {
      background: #6366f1;
      color: white;
      padding: 0.3rem 0.7rem;
      font-size: 0.75rem;
      font-weight: 600;
      border-radius: 6px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .module-card.completed .module-label {
      background: #10b981;
    }

    .module-card.current .module-label {
      background: #f59e0b;
    }

    .module-card.locked .module-label {
      background: #6b7280;
    }

    .favorite-btn {
      background: none;
      border: none;
      cursor: pointer;
      padding: 0.5rem;
      border-radius: 8px;
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* –ì–ª–æ–±–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è —É–±–∏—Ä–∞–Ω–∏—è –≤—Å–µ—Ö –æ–±–≤–æ–¥–æ–∫ */
    * {
      outline: none !important;
      -webkit-tap-highlight-color: transparent !important;
    }

    *:focus {
      outline: none !important;
      box-shadow: none !important;
    }

    *:active {
      outline: none !important;
      box-shadow: none !important;
    }

    *:focus-visible {
      outline: none !important;
      box-shadow: none !important;
    }

    /* –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ */
    button {
      outline: none !important;
      border: none;
      -webkit-tap-highlight-color: transparent !important;
    }

    button:focus {
      outline: none !important;
      box-shadow: none !important;
    }

    button:active {
      outline: none !important;
      box-shadow: none !important;
    }

    button:focus-visible {
      outline: none !important;
      box-shadow: none !important;
    }

    /* –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ –º–æ–¥—É–ª–µ–π */
    .module-card {
      outline: none !important;
      -webkit-tap-highlight-color: transparent !important;
    }

    .module-card:focus {
      outline: none !important;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06) !important;
      border: 1px solid #e5e7eb !important;
    }

    .module-card:active {
      outline: none !important;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06) !important;
      border: 1px solid #e5e7eb !important;
    }

    /* –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫ */
    .nav-button {
      outline: none !important;
      -webkit-tap-highlight-color: transparent !important;
    }

    .nav-button:focus {
      outline: none !important;
      box-shadow: none !important;
    }

    .nav-button:active {
      outline: none !important;
      box-shadow: none !important;
    }

    .favorite-icon {
      width: 24px;
      height: 24px;
      fill: #d1d5db;
      transition: fill 0.2s ease;
    }

    .favorite-btn.active .favorite-icon {
      fill: #fbbf24;
    }

    .module-content {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .module-info {
      flex: 1;
    }

    .module-title {
      font-size: 1.4rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
      color: #2c3e50;
    }



    .info-btn {
      background: #2196F3;
      border: none;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 0.8rem;
      color: white;
      transition: all 0.2s ease;
      flex-shrink: 0;
    }

    .info-btn:hover {
      background: #1976D2;
      color: white;
    }

    .notification {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: #ffffff;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      padding: 1rem 2rem;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      z-index: 1000;
      font-size: 0.9rem;
      color: #2c3e50;
      opacity: 0;
      transition: opacity 0.3s ease;
      min-width: 280px;
      max-width: 90vw;
      text-align: center;
    }

    .notification.show {
      opacity: 1;
    }

    .notification a {
      color: #2196F3;
      text-decoration: none;
      font-weight: 600;
    }

    .notification a:hover {
      text-decoration: underline;
    }

    /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –º–æ–¥—É–ª–µ */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .modal-overlay.show {
      opacity: 1;
      visibility: visible;
    }

    .modal-content {
      background: white;
      border-radius: 12px;
      padding: 1.5rem;
      max-width: 90%;
      width: 400px;
      max-height: 80%;
      overflow-y: auto;
      position: relative;
      transform: scale(0.9);
      transition: transform 0.3s ease;
    }

    .modal-overlay.show .modal-content {
      transform: scale(1);
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
      padding-bottom: 0.5rem;
      border-bottom: 1px solid #e5e7eb;
    }

    .modal-title {
      font-size: 1.2rem;
      font-weight: 600;
      color: #2c3e50;
      margin: 0;
    }

    .modal-close {
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      padding: 0.2rem;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 6px;
      color: #6c757d;
      transition: all 0.2s ease;
    }

    .modal-close:hover {
      background: #f3f4f6;
      color: #374151;
    }

    .modal-body {
      color: #6c757d;
      line-height: 1.6;
      font-size: 0.95rem;
    }

    .module-progress {
      margin-bottom: 1rem;
    }

    .progress-label {
      font-size: 0.8rem;
      color: #6c757d;
      margin-bottom: 0.3rem;
      font-weight: 500;
    }

    .progress-bar-container {
      background: #f1f3f4;
      border-radius: 6px;
      height: 8px;
      overflow: hidden;
      position: relative;
    }

    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #8b5cf6, #a855f7);
      border-radius: 6px;
      transition: width 0.5s ease;
      position: relative;
    }

    .progress-text {
      font-size: 0.8rem;
      color: #6c757d;
      margin-top: 0.3rem;
      font-weight: 500;
    }

    .module-start-btn {
      border: none;
      border-radius: 10px;
      padding: 0.8rem 1.5rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 0.9rem;
      margin-top: 0.5rem;
      width: 100%;
      text-align: center;
    }

    .module-card.completed .module-start-btn {
      background: #e8f5e8;
      color: #4CAF50;
      border: 2px solid #4CAF50;
    }

    .module-card.current .module-start-btn {
      background: #FF9800;
      color: white;
      border: 2px solid #FF9800;
    }

    .module-card.locked .module-start-btn {
      background: #e0e0e0;
      color: #999;
      cursor: not-allowed;
      border: 2px solid #e0e0e0;
    }

    .module-card:not(.locked) .module-start-btn:hover {
      transform: translateY(-2px);
    }

    /* –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å */
    .navigation-panel {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: #ffffff;
      border-top: 1px solid #e0e0e0;
      padding: 0.6rem 0;
      display: flex;
      justify-content: space-around;
      align-items: center;
      box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
    }

    .nav-button {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 0.4rem 0.8rem;
      background: none;
      border: none;
      cursor: pointer;
      transition: all 0.2s ease;
      min-width: 56px;
      border-radius: 6px;
    }

    .nav-button:hover {
      background: #f8f9fa;
    }

    .nav-button.active {
      background: #e3f2fd;
    }

    .nav-icon {
      width: 19px;
      height: 19px;
      margin-bottom: 0.2rem;
      fill: #6c757d;
      transition: fill 0.2s ease;
    }

    .nav-button:hover .nav-icon,
    .nav-button.active .nav-icon {
      fill: #2196F3;
    }

    .nav-label {
      font-size: 0.64rem;
      color: #6c757d;
      font-weight: 500;
      transition: color 0.2s ease;
    }

    .nav-button:hover .nav-label,
    .nav-button.active .nav-label {
      color: #2196F3;
    }

    /* –ó–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —ç–∫—Ä–∞–Ω */
    .loading-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: calc(100% - 80px);
      background: #ffffff;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      transition: opacity 0.5s ease;
    }

    .loading-screen.hidden {
      opacity: 0;
      pointer-events: none;
    }

    .spinner {
      width: 50px;
      height: 50px;
      border: 4px solid #f3f4f6;
      border-top: 4px solid #8b5cf6;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
    @media (max-width: 768px) {
      .main-content {
        padding: 1rem 0.5rem;
        padding-bottom: 80px;
      }

      .welcome-section {
        padding: 1.5rem;
        margin-bottom: 2rem;
      }

      .welcome-title {
        font-size: 1.8rem;
      }

      .welcome-subtitle {
        font-size: 1rem;
      }

      .module-card {
        padding: 1rem;
      }

      .module-content {
        flex-direction: column;
        gap: 0.5rem;
      }

      .module-icon {
        font-size: 2rem;
        align-self: flex-start;
      }

      .module-title {
        font-size: 1.2rem;
      }

      .module-description {
        font-size: 0.9rem;
      }
    }

    /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Å–±—Ä–æ—Å–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ */
    .reset-modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1001;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .reset-modal-overlay.show {
      opacity: 1;
      visibility: visible;
    }

    .reset-modal-content {
      background: white;
      border-radius: 12px;
      padding: 1.5rem;
      max-width: 90%;
      width: 400px;
      max-height: 80%;
      overflow-y: auto;
      position: relative;
      transform: scale(0.9);
      transition: transform 0.3s ease;
    }

    .reset-modal-overlay.show .reset-modal-content {
      transform: scale(1);
    }

    .reset-modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
      padding-bottom: 0.5rem;
      border-bottom: 1px solid #e5e7eb;
    }

    .reset-modal-title {
      font-size: 1.2rem;
      font-weight: 600;
      color: #2c3e50;
      margin: 0;
    }

    .reset-modal-close {
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      padding: 0.2rem;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 6px;
      color: #6c757d;
      transition: all 0.2s ease;
    }

    .reset-modal-close:hover {
      background: #f3f4f6;
      color: #374151;
    }

    .reset-modal-body {
      color: #6c757d;
      line-height: 1.6;
      font-size: 0.95rem;
      margin-bottom: 1.5rem;
    }

    .reset-modal-actions {
      display: flex;
      justify-content: center;
      gap: 0.75rem;
    }

    .reset-modal-actions button {
      border: none;
      border-radius: 8px;
      padding: 0.75rem 1.25rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 0.9rem;
      min-width: 100px;
    }

    .cancel-reset-btn {
      background: #e5e7eb;
      color: #374151;
    }

    .cancel-reset-btn:hover {
      background: #d1d5db;
    }

    .confirm-reset-btn {
      background: #ef4444;
      color: white;
      position: relative;
    }

    .confirm-reset-btn:hover:not(:disabled) {
      background: #dc2626;
    }

    .confirm-reset-btn:disabled {
      background: #ef4444;
      opacity: 0.7;
      cursor: not-allowed;
    }

    .reset-loading {
      display: none;
      width: 16px;
      height: 16px;
      border: 2px solid #ffffff40;
      border-top: 2px solid #ffffff;
      border-radius: 50%;
      animation: resetSpin 1s linear infinite;
      margin-right: 8px;
    }

    @keyframes resetSpin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <!-- –ó–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —ç–∫—Ä–∞–Ω -->
  <div class="loading-screen" id="loadingScreen">
    <div class="spinner"></div>
  </div>

  <div class="main-content">
    <div class="progress-section" id="progressSection">
      <h1 class="progress-title">–û–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å</h1>
      <p class="progress-subtitle">–í–∞—à–µ –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ –ø–æ –∫—É—Ä—Å—É</p>
      <div class="overall-progress">
        <div class="overall-progress-label">
          <span>–ü—Ä–æ–π–¥–µ–Ω–æ –±–ª–æ–∫–æ–≤</span>
          <span id="overallProgressText">0/57</span>
        </div>
        <div class="overall-progress-bar-container">
          <div class="overall-progress-bar" id="overallProgressBar" style="width: 0%"></div>
        </div>
        <div style="text-align: left; margin-top: 0.5rem; font-size: 0.9rem; color: #6c757d; font-weight: 500;" id="overallProgressPercent">0%</div>
      </div>
    </div>

    <div class="modules-container" id="modulesContainer">
      <!-- –ú–æ–¥—É–ª–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ JavaScript -->
    </div>
  </div>

  <div class="navigation-panel">
    <button class="nav-button active" id="guidesBtn">
      <svg class="nav-icon" viewBox="0 0 24 24">
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/>
      </svg>
      <span class="nav-label">–ö—É—Ä—Å</span>
    </button>

    <button class="nav-button" id="favoriteBtn">
      <svg class="nav-icon" viewBox="0 0 24 24">
        <path d="M4 2v20l8-4 8 4V2H4z"/>
      </svg>
      <span class="nav-label">–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</span>
    </button>

    <button class="nav-button" id="aiToolsBtn">
      <svg class="nav-icon" viewBox="0 0 24 24">
        <path d="M20 2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h4l4 4 4-4h4c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"/>
      </svg>
      <span class="nav-label">–ò–ò —á–∞—Ç</span>
    </button>

    <button class="nav-button" id="profileBtn">
      <svg class="nav-icon" viewBox="0 0 24 24">
        <path d="M12 2C13.1 2 14 2.9 14 4C14 5.1 13.1 6 12 6C10.9 6 10 5.1 10 4C10 2.9 10.9 2 12 2ZM21 9V7L15 7V9C15 11.7 12.7 14 10 14S5 11.7 5 9V7H3V9C3 12.4 5.4 15.1 8.5 15.8V18H7V20H17V18H15.5V15.8C18.6 15.1 21 12.4 21 9Z"/>
      </svg>
      <span class="nav-label">–ü—Ä–æ—Ñ–∏–ª—å</span>
    </button>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –º–æ–¥—É–ª–µ -->
  <div class="modal-overlay" id="moduleInfoModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title" id="modalTitle">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–æ–¥—É–ª–µ</h3>
        <button class="modal-close" id="modalClose">√ó</button>
      </div>
      <div class="modal-body" id="modalBody">
        <!-- –û–ø–∏—Å–∞–Ω–∏–µ –º–æ–¥—É–ª—è –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–æ –∑–¥–µ—Å—å -->
      </div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Å–±—Ä–æ—Å–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ -->
  <div class="reset-modal-overlay" id="resetProgressModal">
    <div class="reset-modal-content">
      <div class="reset-modal-header">
        <h3 class="reset-modal-title">–°–±—Ä–æ—Å –ø—Ä–æ–≥—Ä–µ—Å—Å–∞</h3>
        <button class="reset-modal-close" id="resetModalClose">√ó</button>
      </div>
      <div class="reset-modal-body">
        <p>–í—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—Ç–∏—Ç–µ –ø–µ—Ä–µ–ø—Ä–æ–π—Ç–∏ "<span id="resetModuleName"></span>"?</p>
        <p>–í–∞—à –ø—Ä–æ–≥—Ä–µ—Å—Å –±—É–¥–µ—Ç —Å–±—Ä–æ—à–µ–Ω –¥–æ 0.</p>
      </div>
      <div class="reset-modal-actions">
        <button class="cancel-reset-btn" id="cancelResetBtn">–û—Ç–º–µ–Ω–∞</button>
        <button class="confirm-reset-btn" id="confirmResetBtn">
          <span class="reset-loading" id="resetLoading"></span>
          <span id="resetBtnText">–°–±—Ä–æ—Å–∏—Ç—å</span>
        </button>
      </div>
    </div>
  </div>

  <script>
    // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è NocoDB
    const config = {
      orgs: 'weamcfo6',
      projectName: 'p27jdsmk69wuimh',
      tableName: 'mc6qh91f060pv4y',
      apiToken: 'bocQfycJpJsTG_tbwEf8ma8E5rhoig0njMDXFWtJ',
      baseUrl: 'https://app.nocodb.com/api/v1/db/data'
    };

    // –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª–µ–π
    const modules = [
      {
        id: 'intro',
        icon: 'üëã',
        title: '–ó–Ω–∞–∫–æ–º—Å—Ç–≤–æ —Å –∫—É—Ä—Å',
        label: '–í—Å—Ç—É–ø–ª–µ–Ω–∏–µ',
        description: '–ó–Ω–∞–∫–æ–º—Å—Ç–≤–æ —Å –∫—É—Ä—Å–æ–º –∏ –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –ø—Ä–∏–Ω—Ü–∏–ø–∞–º–∏ —Ä–∞–±–æ—Ç—ã —Å –ò–ò',
        file: 'intro.html',
        requiredProgress: 0,
        progressField: 'INTRO_progress'
      },
      {
        id: 'm1',
        icon: 'üß†',
        title: '–û—Å–Ω–æ–≤—ã –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞',
        label: '–ú–æ–¥—É–ª—å 1',
        description: '–û—Å–Ω–æ–≤—ã –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞. –ò–∑—É—á–∏—Ç–µ –±–∞–∑–æ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –∏ –ø—Ä–∏–Ω—Ü–∏–ø—ã',
        file: 'M1.html',
        requiredProgress: 1,
        progressField: 'M1_progress'
      },
      {
        id: 'm2',
        icon: 'üöÄ',
        title: '–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ –ò–ò',
        label: '–ú–æ–¥—É–ª—å 2',
        description: '–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ —Ä–∞–±–æ—Ç—ã —Å –ò–ò. –£–≥–ª—É–±–∏—Ç–µ —Å–≤–æ–∏ –∑–Ω–∞–Ω–∏—è',
        file: 'M2.html',
        requiredProgress: 2,
        progressField: 'M2_progress'
      },
      {
        id: 'm3',
        icon: '‚ö°',
        title: '–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ',
        label: '–ú–æ–¥—É–ª—å 3',
        description: '–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ò–ò. –†–∞–±–æ—Ç–∞ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏',
        file: 'M3.html',
        requiredProgress: 3,
        progressField: 'M3_progress'
      },
      {
        id: 'm4',
        icon: 'üéØ',
        title: '–ú–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ —Ä–∞–±–æ—Ç—ã —Å –ò–ò',
        label: '–ú–æ–¥—É–ª—å 4',
        description: '–ú–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ —Ä–∞–±–æ—Ç—ã —Å –ò–ò. –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π',
        file: 'M4.html',
        requiredProgress: 4,
        progressField: 'M4_progress'
      }
    ];

    let userProgress = 0;
    let userPayment = 0;
    let userId = null;
    let lastUpdateTime = 0;
    let checkInterval = null;
    let moduleProgress = {};
    let currentModuleId = null; // ID —Ç–µ–∫—É—â–µ–≥–æ –º–æ–¥—É–ª—è –¥–ª—è —Å–±—Ä–æ—Å–∞

    // –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ cookies
    function getCookie(name) {
      const value = `; ${document.cookie}`;
      const parts = value.split(`; ${name}=`);
      if (parts.length === 2) return parts.pop().split(';').shift();
      return null;
    }

    // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏–∑–±—Ä–∞–Ω–Ω—ã–º
    function getFavorites() {
      const favorites = localStorage.getItem('favoriteModules');
      return favorites ? JSON.parse(favorites) : [];
    }

    function toggleFavorite(moduleId) {
      let favorites = getFavorites();
      const index = favorites.indexOf(moduleId);

      if (index > -1) {
        favorites.splice(index, 1);
      } else {
        favorites.push(moduleId);
      }

      localStorage.setItem('favoriteModules', JSON.stringify(favorites));

      // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –∫–Ω–æ–ø–∫—É –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ –±–µ–∑ –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–∞
      const moduleCards = document.querySelectorAll('.module-card');
      moduleCards.forEach(card => {
        const cardModuleId = modules.find(m => card.innerHTML.includes(m.title))?.id;
        if (cardModuleId === moduleId) {
          const favoriteBtn = card.querySelector('.favorite-btn');
          if (isFavorite(moduleId)) {
            favoriteBtn.classList.add('active');
          } else {
            favoriteBtn.classList.remove('active');
          }
        }
      });
    }

    function isFavorite(moduleId) {
      return getFavorites().includes(moduleId);
    }

    // –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ NocoDB
    async function getUserData(isUpdate = false) {
      userId = getCookie('tg_user_id');

      if (!userId) {
        console.log('User ID not found in cookies');
        userProgress = 0;
        userPayment = 0;
        moduleProgress = {};
        if (!isUpdate) renderModules();
        return Promise.resolve();
      }

      try {
        const response = await fetch(`${config.baseUrl}/${config.orgs}/${config.projectName}/${config.tableName}`, {
          headers: {
            'xc-token': config.apiToken
          }
        });

        if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);

        const data = await response.json();
        const user = data.list.find(u => u.tg_user_id == userId);

        if (user) {
          const newProgress = user.progress || 0;
          const newPayment = user.oplata || 0;

          // –ü–æ–ª—É—á–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ –º–æ–¥—É–ª—è–º
          const newModuleProgress = {};
          modules.forEach(module => {
            newModuleProgress[module.id] = user[module.progressField] || 0;
          });

          // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∏–∑–º–µ–Ω–∏–ª–∏—Å—å –ª–∏ –¥–∞–Ω–Ω—ã–µ
          if (isUpdate && (newProgress !== userProgress || newPayment !== userPayment || 
              JSON.stringify(newModuleProgress) !== JSON.stringify(moduleProgress))) {
            console.log('–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω—ã:', { 
              progress: newProgress, 
              payment: newPayment,
              moduleProgress: newModuleProgress
            });

            userProgress = newProgress;
            userPayment = newPayment;
            moduleProgress = newModuleProgress;
            lastUpdateTime = Date.now();

            // –ü–ª–∞–≤–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
            updateInterface();
          } else if (!isUpdate) {
            userProgress = newProgress;
            userPayment = newPayment;
            moduleProgress = newModuleProgress;
            lastUpdateTime = Date.now();
            renderModules();
          }
        } else {
          if (!isUpdate) {
            userProgress = 0;
            userPayment = 0;
            moduleProgress = {};
            renderModules();
          }
        }
      } catch (error) {
        console.error('Error fetching user data:', error);
        if (!isUpdate) {
          userProgress = 0;
          userPayment = 0;
          moduleProgress = {};
          renderModules();
        }
      }
    }

    // –ü–ª–∞–≤–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
    function updateInterface() {
      const modulesContainer = document.getElementById('modulesContainer');

      // –î–æ–±–∞–≤–ª—è–µ–º –ø–ª–∞–≤–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥
      modulesContainer.style.transition = 'opacity 0.3s ease';
      modulesContainer.style.opacity = '0.7';

      setTimeout(() => {
        renderModules();
        modulesContainer.style.opacity = '1';
      }, 150);
    }

    // –ó–∞–ø—É—Å–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
    function startAutoUpdate() {
      // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –µ—Å–ª–∏ –µ—Å—Ç—å
      if (checkInterval) {
        clearInterval(checkInterval);
      }

      // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –∫–∞–∂–¥—ã–µ 3 —Å–µ–∫—É–Ω–¥—ã
      checkInterval = setInterval(() => {
        getUserData(true);
      }, 3000);

      console.log('–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –∑–∞–ø—É—â–µ–Ω–∞ (–∫–∞–∂–¥—ã–µ 3 —Å–µ–∫)');
    }

    // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
    function stopAutoUpdate() {
      if (checkInterval) {
        clearInterval(checkInterval);
        checkInterval = null;
        console.log('–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞');
      }
    }

    // –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–æ–¥—É–ª—è
    function getModuleState(module, index) {
      if (userProgress === 5) {
        return 'completed'; // –í—Å–µ –º–æ–¥—É–ª–∏ –∑–∞–≤–µ—Ä—à–µ–Ω—ã
      }

      if (userProgress > module.requiredProgress) {
        return 'completed'; // –ú–æ–¥—É–ª—å –ø—Ä–æ–π–¥–µ–Ω
      }

      // –õ–æ–≥–∏–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ –º–æ–¥—É–ª—è
      if (module.id === 'intro' && userProgress === 0) {
        return 'current';
      } else if (module.id === 'm1' && (userProgress >= 1 || userPayment > 0)) {
        return userProgress === 1 ? 'current' : 'completed';
      } else if (userProgress >= module.requiredProgress) {
        return userProgress === module.requiredProgress ? 'current' : 'completed';
      }

      return 'locked'; // –ú–æ–¥—É–ª—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω
    }

    // –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å –º–æ–¥—É–ª–∏
    function renderModules() {
      const modulesContainer = document.getElementById('modulesContainer');
      modulesContainer.innerHTML = '';

      modules.forEach((module, index) => {
        const moduleState = getModuleState(module, index);

        // –õ–æ–≥–∏–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
        let isAvailable = false;
        let buttonText = '–ù–∞—á–∞—Ç—å';

        if (module.id === 'intro') {
          isAvailable = true;
        } else if (module.id === 'm1') {
          isAvailable = userProgress >= module.requiredProgress || userPayment > 0;
        } else {
          isAvailable = userProgress >= module.requiredProgress;
        }

        if (moduleState === 'completed') {
          buttonText = '–ü–æ–≤—Ç–æ—Ä–∏—Ç—å';
        } else if (moduleState === 'current') {
          buttonText = '–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å';
        } else if (!isAvailable) {
          buttonText = userPayment === 0 && module.id === 'm1' ? '–¢—Ä–µ–±—É–µ—Ç—Å—è –æ–ø–ª–∞—Ç–∞' : '–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ';
        }

        // –ü–æ–ª—É—á–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –º–æ–¥—É–ª—è (–¥–ª—è –ú1 –¥–æ 17, –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –¥–æ 10)
        const maxProgress = module.id === 'm1' ? 17 : 10;
        const currentModuleProgress = moduleProgress[module.id] || 0;
        const progressPercentage = (currentModuleProgress / maxProgress) * 100;

        const moduleCard = document.createElement('div');
        moduleCard.className = `module-card ${moduleState}`;



        moduleCard.innerHTML = `
          <div class="module-header">
            <div style="display: flex; align-items: center; gap: 0.5rem;">
              <div class="module-label">${module.label}</div>
              <button class="info-btn" data-description="${module.description}">i</button>
            </div>
            <button class="favorite-btn ${isFavorite(module.id) ? 'active' : ''}">
              <svg class="favorite-icon" viewBox="0 0 24 24">
                <path d="M4 2v20l8-4 8 4V2H4z"/>
              </svg>
            </button>
          </div>
          <div class="module-content">
            <div class="module-info">
              <h3 class="module-title">${module.title}</h3>

              <div class="module-progress">
                <div class="progress-label">–ü—Ä–æ–≥—Ä–µ—Å—Å –º–æ–¥—É–ª—è</div>
                <div class="progress-bar-container">
                  <div class="progress-bar" style="width: ${progressPercentage}%"></div>
                </div>
                <div class="progress-text">${currentModuleProgress}/${maxProgress}</div>
              </div>

              <button class="module-start-btn" data-file="${module.file}" data-available="${isAvailable}">${buttonText}</button>
            </div>
          </div>
        `;

        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–∞
        const favoriteBtn = moduleCard.querySelector('.favorite-btn');
        const infoBtn = moduleCard.querySelector('.info-btn');
        const startBtn = moduleCard.querySelector('.module-start-btn');

        favoriteBtn.addEventListener('click', (e) => {
          e.preventDefault();
          e.stopPropagation();
          toggleFavorite(module.id);
          showFavoriteNotification(module.label, module.id);
          return false;
        });

        infoBtn.addEventListener('click', (e) => {
          e.preventDefault();
          e.stopPropagation();
          showModuleInfo(module.description, module.title);
          return false;
        });

        if (isAvailable) {
          startBtn.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            if (buttonText === '–ü–æ–≤—Ç–æ—Ä–∏—Ç—å') {
              // –û—Ç–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Å–±—Ä–æ—Å–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
              currentModuleId = module.id;
              document.getElementById('resetModuleName').textContent = module.title;
              openResetModal();
            } else {
              startModule(module.file);
            }
            return false;
          });
        }

        modulesContainer.appendChild(moduleCard);
      });

      // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
      updateUserInfo();
    }

    // –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –∏ –æ–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å
    function updateUserInfo() {
      const progressTitle = document.querySelector('.progress-title');
      const progressSubtitle = document.querySelector('.progress-subtitle');

      if (progressTitle) {
        progressTitle.textContent = '–û–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å';
      }

      // –û–±–Ω–æ–≤–ª—è–µ–º –æ–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å
      updateOverallProgress();

      if (progressSubtitle) {
        progressSubtitle.textContent = '–í–∞—à–µ –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ –ø–æ –∫—É—Ä—Å—É';
      }
    }

    // –û–±–Ω–æ–≤–∏—Ç—å –æ–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å
    function updateOverallProgress() {
      const totalBlocks = 57; // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–ª–æ–∫–æ–≤ –≤–æ –≤—Å–µ—Ö –º–æ–¥—É–ª—è—Ö
      let completedBlocks = 0;

      // –°—á–∏—Ç–∞–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –±–ª–æ–∫–∏ –∏–∑ –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π
      modules.forEach(module => {
        const moduleProgressValue = moduleProgress[module.id] || 0;
        completedBlocks += moduleProgressValue;
      });

      const progressPercentage = (completedBlocks / totalBlocks) * 100;

      const progressBar = document.getElementById('overallProgressBar');
      const progressText = document.getElementById('overallProgressText');
      const progressPercent = document.getElementById('overallProgressPercent');

      if (progressBar) {
        progressBar.style.width = `${progressPercentage}%`;
      }

      if (progressText) {
        progressText.textContent = `${completedBlocks}/${totalBlocks}`;
      }

      if (progressPercent) {
        progressPercent.textContent = `${Math.round(progressPercentage)}%`;
      }
    }

    // –ù–∞—á–∞—Ç—å –º–æ–¥—É–ª—å
    function startModule(file) {
      window.location.href = file;
    }

    // –°–±—Ä–æ—Å –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –º–æ–¥—É–ª—è
    async function resetModuleProgress() {
      const moduleId = currentModuleId;
      const module = modules.find(m => m.id === moduleId);

      if (!module) {
        console.error('Module not found');
        closeResetModal();
        return;
      }

      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
      showResetLoading();

      try {
        // –°–Ω–∞—á–∞–ª–∞ –ø–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        const response = await fetch(`${config.baseUrl}/${config.orgs}/${config.projectName}/${config.tableName}`, {
          headers: {
            'xc-token': config.apiToken
          }
        });

        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }

        const data = await response.json();
        const user = data.list.find(u => u.tg_user_id == userId);

        if (!user) {
          throw new Error('User not found');
        }

        // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –º–æ–¥—É–ª—è –Ω–∞ 0
        const updateData = {};
        updateData[module.progressField] = 0;

        const updateResponse = await fetch(`${config.baseUrl}/${config.orgs}/${config.projectName}/${config.tableName}/${user.Id}`, {
          method: 'PATCH',
          headers: {
            'xc-token': config.apiToken,
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(updateData)
        });

        if (!updateResponse.ok) {
          throw new Error(`HTTP error! status: ${updateResponse.status}`);
        }

        console.log(`–ü—Ä–æ–≥—Ä–µ—Å—Å –º–æ–¥—É–ª—è ${module.progressField} —Å–±—Ä–æ—à–µ–Ω –¥–æ 0`);

        // –°–∫—Ä—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
        hideResetLoading();
        
        // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
        closeResetModal();

        // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –∏ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –º–æ–¥—É–ª—é
        await getUserData(true);
        
        // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –º–æ–¥—É–ª—é
        window.location.href = module.file;

      } catch (error) {
        console.error('Error resetting module progress:', error);
        hideResetLoading();
        closeResetModal();
      }
    }

    // –ü–æ–∫–∞–∑–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –≤ –∫–Ω–æ–ø–∫–µ —Å–±—Ä–æ—Å–∞
    function showResetLoading() {
      const confirmBtn = document.getElementById('confirmResetBtn');
      const cancelBtn = document.getElementById('cancelResetBtn');
      const loading = document.getElementById('resetLoading');
      const btnText = document.getElementById('resetBtnText');

      confirmBtn.disabled = true;
      cancelBtn.disabled = true;
      loading.style.display = 'inline-block';
      btnText.textContent = '–°–±—Ä–æ—Å...';
    }

    // –°–∫—Ä—ã—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –≤ –∫–Ω–æ–ø–∫–µ —Å–±—Ä–æ—Å–∞
    function hideResetLoading() {
      const confirmBtn = document.getElementById('confirmResetBtn');
      const cancelBtn = document.getElementById('cancelResetBtn');
      const loading = document.getElementById('resetLoading');
      const btnText = document.getElementById('resetBtnText');

      confirmBtn.disabled = false;
      cancelBtn.disabled = false;
      loading.style.display = 'none';
      btnText.textContent = '–°–±—Ä–æ—Å–∏—Ç—å';
    }

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
    document.getElementById('guidesBtn').addEventListener('click', () => {
      // –û—Å—Ç–∞–µ–º—Å—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∫—É—Ä—Å–∞, —Ç–∞–∫ –∫–∞–∫ –º—ã —É–∂–µ –∑–¥–µ—Å—å
      return;
    });

    document.getElementById('favoriteBtn').addEventListener('click', () => {
      window.location.href = 'favorite.html';
    });

    document.getElementById('aiToolsBtn').addEventListener('click', () => {
      window.location.href = 'chat.html';
    });

    document.getElementById('profileBtn').addEventListener('click', () => {
      window.location.href = 'profile.html';
    });

    // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –º–æ–¥—É–ª–µ
    function showModuleInfo(description, title = '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–æ–¥—É–ª–µ') {
      const modal = document.getElementById('moduleInfoModal');
      const modalTitle = document.getElementById('modalTitle');
      const modalBody = document.getElementById('modalBody');

      modalTitle.textContent = title;
      modalBody.textContent = description;

      modal.classList.add('show');
    }

    // –§—É–Ω–∫—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
    function closeModuleInfo() {
      const modal = document.getElementById('moduleInfoModal');
      modal.classList.remove('show');
    }

    // –§—É–Ω–∫—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Å–±—Ä–æ—Å–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
    function openResetModal() {
      const modal = document.getElementById('resetProgressModal');
      modal.classList.add('show');
    }

    // –§—É–Ω–∫—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Å–±—Ä–æ—Å–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
    function closeResetModal() {
      const modal = document.getElementById('resetProgressModal');
      modal.classList.remove('show');
    }

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
    document.addEventListener('DOMContentLoaded', () => {
      const modal = document.getElementById('moduleInfoModal');
      const modalClose = document.getElementById('modalClose');

      // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–Ω–æ–ø–∫–µ
      modalClose.addEventListener('click', closeModuleInfo);

      // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –Ω–∞ —Ñ–æ–Ω
      modal.addEventListener('click', (e) => {
        if (e.target === modal) {
          closeModuleInfo();
        }
      });

      // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ Escape
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && modal.classList.contains('show')) {
          closeModuleInfo();
        }
      });

      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Å–±—Ä–æ—Å–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
      const resetModal = document.getElementById('resetProgressModal');
      const resetModalClose = document.getElementById('resetModalClose');
      const cancelResetBtn = document.getElementById('cancelResetBtn');
      const confirmResetBtn = document.getElementById('confirmResetBtn');

      // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–Ω–æ–ø–∫–µ
      resetModalClose.addEventListener('click', closeResetModal);
      cancelResetBtn.addEventListener('click', closeResetModal);

      // –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å–±—Ä–æ—Å–∞
      confirmResetBtn.addEventListener('click', resetModuleProgress);

      // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –Ω–∞ —Ñ–æ–Ω
      resetModal.addEventListener('click', (e) => {
        if (e.target === resetModal) {
          closeResetModal();
        }
      });

      // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ Escape –¥–ª—è reset modal
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && resetModal.classList.contains('show')) {
          closeResetModal();
        }
      });
    });

    // –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
    let currentNotification = null;

    // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
    function showFavoriteNotification(moduleLabel, moduleId) {
      // –°–∫—Ä—ã–≤–∞–µ–º —Ç–µ–∫—É—â–µ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –µ—Å–ª–∏ –µ—Å—Ç—å
      if (currentNotification) {
        currentNotification.classList.remove('show');
        setTimeout(() => {
          if (currentNotification.parentNode) {
            currentNotification.parentNode.removeChild(currentNotification);
          }
        }, 300);
      }

      // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
      const notification = document.createElement('div');
      notification.className = 'notification';
      currentNotification = notification;

      const isFav = isFavorite(moduleId);
      const action = isFav ? '–¥–æ–±–∞–≤–ª–µ–Ω–æ –≤' : '—É–¥–∞–ª–µ–Ω–æ –∏–∑';

      notification.innerHTML = `
        ${moduleLabel} ${action} <a href="favorite.html">–∏–∑–±—Ä–∞–Ω–Ω–æ–µ</a>
      `;

      document.body.appendChild(notification);

      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
      setTimeout(() => {
        notification.classList.add('show');
      }, 100);

      // –°–∫—Ä—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
      setTimeout(() => {
        notification.classList.remove('show');
        setTimeout(() => {
          if (notification.parentNode) {
            notification.parentNode.removeChild(notification);
          }
          // –û—á–∏—â–∞–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ —Ç–µ–∫—É—â–µ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
          if (currentNotification === notification) {
            currentNotification = null;
          }
        }, 300);
      }, 2000);
    }

    // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
    window.toggleFavorite = toggleFavorite;
    window.showModuleInfo = showModuleInfo;

    // –§—É–Ω–∫—Ü–∏—è —Å–∫—Ä—ã—Ç–∏—è –∑–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞
    function hideLoadingScreen() {
      const loadingScreen = document.getElementById('loadingScreen');
      if (loadingScreen) {
        loadingScreen.classList.add('hidden');
        // –ü–æ–ª–Ω–æ—Å—Ç—å—é —É–±–∏—Ä–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç —á–µ—Ä–µ–∑ 500ms –ø–æ—Å–ª–µ –Ω–∞—á–∞–ª–∞ –∞–Ω–∏–º–∞—Ü–∏–∏
        setTimeout(() => {
          loadingScreen.style.display = 'none';
        }, 500);
      }
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    document.addEventListener('DOMContentLoaded', () => {
      getUserData().then(() => {
        // –°–∫—Ä—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —ç–∫—Ä–∞–Ω –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
        hideLoadingScreen();
      });
      startAutoUpdate();

      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
      const modal = document.getElementById('moduleInfoModal');
      const modalClose = document.getElementById('modalClose');

      // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–Ω–æ–ø–∫–µ
      modalClose.addEventListener('click', closeModuleInfo);

      // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –Ω–∞ —Ñ–æ–Ω
      modal.addEventListener('click', (e) => {
        if (e.target === modal) {
          closeModuleInfo();
        }
      });

      // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ Escape
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && modal.classList.contains('show')) {
          closeModuleInfo();
        }
      });
    });

    // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∏ —É—Ö–æ–¥–µ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    window.addEventListener('beforeunload', () => {
      stopAutoUpdate();
    });

    // –í–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
    document.addEventListener('visibilitychange', () => {
      if (document.visibilityState === 'visible') {
        if (!checkInterval) {
          startAutoUpdate();
        }
      } else {
        stopAutoUpdate();
      }
    });
  </script>
</body>
</html>
